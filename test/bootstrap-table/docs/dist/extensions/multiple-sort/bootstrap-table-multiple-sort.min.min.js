!function(g){var f=!1,j=function(a){var o=a.$sortModal.selector,n=o.substr(1);if(!g(n).hasClass("modal")){var m='  <div class="modal fade" id="'+n+'" tabindex="-1" role="dialog" aria-labelledby="'+n+'Label" aria-hidden="true">';m+='         <div class="modal-dialog">',m+='             <div class="modal-content">',m+='                 <div class="modal-header">',m+='                     <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>',m+='                     <h4 class="modal-title" id="'+n+'Label">'+a.options.formatMultipleSort()+"</h4>",m+="                 </div>",m+='                 <div class="modal-body">',m+='                     <div class="bootstrap-table">',m+='                         <div class="fixed-table-toolbar">',m+='                             <div class="bars">',m+='                                 <div id="toolbar">',m+='                                     <button id="add" type="button" class="btn btn-default"><i class="'+a.options.iconsPrefix+" "+a.options.icons.plus+'"></i> '+a.options.formatAddLevel()+"</button>",m+='                                     <button id="delete" type="button" class="btn btn-default" disabled><i class="'+a.options.iconsPrefix+" "+a.options.icons.minus+'"></i> '+a.options.formatDeleteLevel()+"</button>",m+="                                 </div>",m+="                             </div>",m+="                         </div>",m+='                         <div class="fixed-table-container">',m+='                             <table id="multi-sort" class="table">',m+="                                 <thead>",m+="                                     <tr>",m+="                                         <th></th>",m+='                                         <th><div class="th-inner">'+a.options.formatColumn()+"</div></th>",m+='                                         <th><div class="th-inner">'+a.options.formatOrder()+"</div></th>",m+="                                     </tr>",m+="                                 </thead>",m+="                                 <tbody></tbody>",m+="                             </table>",m+="                         </div>",m+="                     </div>",m+="                 </div>",m+='                 <div class="modal-footer">',m+='                     <button type="button" class="btn btn-default" data-dismiss="modal">'+a.options.formatCancel()+"</button>",m+='                     <button type="button" class="btn btn-primary">'+a.options.formatSort()+"</button>",m+="                 </div>",m+="             </div>",m+="         </div>",m+="     </div>",g("body").append(g(m)),a.$sortModal=g(o);var l=a.$sortModal.find("tbody > tr");if(a.$sortModal.off("click","#add").on("click","#add",function(){var b=a.$sortModal.find(".multi-sort-name:first option").length,d=a.$sortModal.find("tbody tr").length;b>d&&(d++,a.addLevel(),a.setButtonStates())}),a.$sortModal.off("click","#delete").on("click","#delete",function(){var b=a.$sortModal.find(".multi-sort-name:first option").length,d=a.$sortModal.find("tbody tr").length;d>1&&b>=d&&(d--,a.$sortModal.find("tbody tr:last").remove(),a.setButtonStates())}),a.$sortModal.off("click",".btn-primary").on("click",".btn-primary",function(){var t=a.$sortModal.find("tbody > tr"),s=a.$sortModal.find("div.alert"),r=[],q=[];a.options.sortPriority=g.map(t,function(e){var w=g(e),v=w.find(".multi-sort-name").val(),u=w.find(".multi-sort-order").val();return r.push(v),{sortName:v,sortOrder:u}});for(var p=r.sort(),b=0;b<r.length-1;b++){p[b+1]==p[b]&&q.push(p[b])}if(q.length>0){0===s.length&&(s='<div class="alert alert-danger" role="alert"><strong>'+a.options.formatDuplicateAlertTitle()+"</strong> "+a.options.formatDuplicateAlertDescription()+"</div>",g(s).insertBefore(a.$sortModal.find(".bars")))}else{if(1===s.length&&g(s).remove(),a.$sortModal.modal("hide"),a.options.sortName="","server"===a.options.sidePagination){return a.options.queryParams=function(c){return c.multiSort=a.options.sortPriority,c},void a.initServer(a.options.silentSort)}a.onMultipleSort()}}),(null===a.options.sortPriority||0===a.options.sortPriority.length)&&a.options.sortName&&(a.options.sortPriority=[{sortName:a.options.sortName,sortOrder:a.options.sortOrder}]),null!==a.options.sortPriority&&a.options.sortPriority.length>0){if(l.length<a.options.sortPriority.length&&"object"==typeof a.options.sortPriority){for(var k=0;k<a.options.sortPriority.length;k++){a.addLevel(k,a.options.sortPriority[k])}}}else{a.addLevel(0)}a.setButtonStates()}};g.extend(g.fn.bootstrapTable.defaults,{showMultiSort:!1,sortPriority:null,onMultipleSort:function(){return !1}}),g.extend(g.fn.bootstrapTable.defaults.icons,{sort:"glyphicon-sort",plus:"glyphicon-plus",minus:"glyphicon-minus"}),g.extend(g.fn.bootstrapTable.Constructor.EVENTS,{"multiple-sort.bs.table":"onMultipleSort"}),g.extend(g.fn.bootstrapTable.locales,{formatMultipleSort:function(){return"Multiple Sort"},formatAddLevel:function(){return"Add Level"},formatDeleteLevel:function(){return"Delete Level"},formatColumn:function(){return"Column"},formatOrder:function(){return"Order"},formatSortBy:function(){return"Sort by"},formatThenBy:function(){return"Then by"},formatSort:function(){return"Sort"},formatCancel:function(){return"Cancel"},formatDuplicateAlertTitle:function(){return"Duplicate(s) detected!"},formatDuplicateAlertDescription:function(){return"Please remove or change any duplicate column."},formatSortOrders:function(){return{asc:"Ascending",desc:"Descending"}}}),g.extend(g.fn.bootstrapTable.defaults,g.fn.bootstrapTable.locales);var i=g.fn.bootstrapTable.Constructor,h=i.prototype.initToolbar;i.prototype.initToolbar=function(){this.showToolbar=!0;var e=this,c="#sortModal_"+this.$el.attr("id");if(this.$sortModal=g(c),h.apply(this,Array.prototype.slice.apply(arguments)),this.options.showMultiSort){var b=this.$toolbar.find(">.btn-group").first(),a=this.$toolbar.find("div.multi-sort");a.length||(a='  <button class="multi-sort btn btn-default'+(void 0===this.options.iconSize?"":" btn-"+this.options.iconSize)+'" type="button" data-toggle="modal" data-target="'+c+'" title="'+this.options.formatMultipleSort()+'">',a+='     <i class="'+this.options.iconsPrefix+" "+this.options.icons.sort+'"></i>',a+="</button>",b.append(a),j(e)),this.$el.on("sort.bs.table",function(){f=!0}),this.$el.on("multiple-sort.bs.table",function(){f=!1}),this.$el.on("load-success.bs.table",function(){f||null===e.options.sortPriority||"object"!=typeof e.options.sortPriority||"server"===e.options.sidePagination||e.onMultipleSort()}),this.$el.on("column-switch.bs.table",function(k,d){for(var l=0;l<e.options.sortPriority.length;l++){e.options.sortPriority[l].sortName===d&&e.options.sortPriority.splice(l,1)}e.assignSortableArrows(),e.$sortModal.remove(),j(e)}),this.$el.on("reset-view.bs.table",function(){f||null===e.options.sortPriority||"object"!=typeof e.options.sortPriority||e.assignSortableArrows()})}},i.prototype.onMultipleSort=function(){var a=this,k=function(d,c){return d>c?1:c>d?-1:0},e=function(q,p){for(var o=[],n=[],m=0;m<a.options.sortPriority.length;m++){var l="desc"===a.options.sortPriority[m].sortOrder?-1:1,c=q[a.options.sortPriority[m].sortName],b=p[a.options.sortPriority[m].sortName];(void 0===c||null===c)&&(c=""),(void 0===b||null===b)&&(b=""),g.isNumeric(c)&&g.isNumeric(b)&&(c=parseFloat(c),b=parseFloat(b)),"string"!=typeof c&&(c=c.toString()),o.push(l*k(c,b)),n.push(l*k(b,c))}return k(o,n)};this.data.sort(function(d,c){return e(d,c)}),this.initBody(),this.assignSortableArrows(),this.trigger("multiple-sort")},i.prototype.addLevel=function(a,n){var m=0===a?this.options.formatSortBy():this.options.formatThenBy();this.$sortModal.find("tbody").append(g("<tr>").append(g("<td>").text(m)).append(g("<td>").append(g('<select class="form-control multi-sort-name">'))).append(g("<td>").append(g('<select class="form-control multi-sort-order">'))));var l=this.$sortModal.find(".multi-sort-name").last(),k=this.$sortModal.find(".multi-sort-order").last();g.each(this.columns,function(d,c){return c.sortable===!1||c.visible===!1?!0:void l.append('<option value="'+c.field+'">'+c.title+"</option>")}),g.each(this.options.formatSortOrders(),function(d,c){k.append('<option value="'+d+'">'+c+"</option>")}),void 0!==n&&(l.find('option[value="'+n.sortName+'"]').attr("selected",!0),k.find('option[value="'+n.sortOrder+'"]').attr("selected",!0))},i.prototype.assignSortableArrows=function(){for(var a=this,m=a.$header.find("th"),l=0;l<m.length;l++){for(var k=0;k<a.options.sortPriority.length;k++){g(m[l]).data("field")===a.options.sortPriority[k].sortName&&g(m[l]).find(".sortable").removeClass("desc asc").addClass(a.options.sortPriority[k].sortOrder)}}},i.prototype.setButtonStates=function(){var d=this.$sortModal.find(".multi-sort-name:first option").length,c=this.$sortModal.find("tbody tr").length;c==d&&this.$sortModal.find("#add").attr("disabled","disabled"),c>1&&this.$sortModal.find("#delete").removeAttr("disabled"),d>c&&this.$sortModal.find("#add").removeAttr("disabled"),1==c&&this.$sortModal.find("#delete").attr("disabled","disabled")}}(jQuery);