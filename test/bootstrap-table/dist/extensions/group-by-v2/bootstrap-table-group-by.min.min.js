!function(p){var q,n;var m=function(a){var c=arguments,d=true,b=1;a=a.replace(/%s/g,function(){var e=c[b++];if(typeof e==="undefined"){d=false;return""}return e});return d?a:""};var k=function(a,b){var c={};a.forEach(function(e){var d=b(e);c[d]=c[d]||[];c[d].push(e)});return c};p.extend(p.fn.bootstrapTable.defaults,{groupBy:false,groupByField:""});var r=p.fn.bootstrapTable.Constructor,l=r.prototype.initSort,j=r.prototype.initBody,o=r.prototype.updateSelected;r.prototype.initSort=function(){l.apply(this,Array.prototype.slice.apply(arguments));var a=this;n=[];if((this.options.groupBy)&&(this.options.groupByField!=="")){if((this.options.sortName!=this.options.groupByField)){this.data.sort(function(e,d){return e[a.options.groupByField].localeCompare(d[a.options.groupByField])})}var a=this;var c=k(a.data,function(d){return[d[a.options.groupByField]]});var b=0;p.each(c,function(d,e){n.push({id:b,name:d});e.forEach(function(f){if(!f._data){f._data={}}f._data["parent-index"]=b});b++})}};r.prototype.initBody=function(){q=true;j.apply(this,Array.prototype.slice.apply(arguments));if((this.options.groupBy)&&(this.options.groupByField!=="")){var a=this,b=false,c=0;this.columns.forEach(function(d){if(d.checkbox){b=true}else{if(d.visible){c+=1}}});if(this.options.detailView&&!this.options.cardView){c+=1}n.forEach(function(e){var d=[];d.push(m('<tr class="info groupBy expanded" data-group-index="%s">',e.id));if(a.options.detailView&&!a.options.cardView){d.push('<td class="detail"></td>')}if(b){d.push('<td class="bs-checkbox">','<input name="btSelectGroup" type="checkbox" />',"</td>")}d.push("<td",m(' colspan="%s"',c),">",e.name,"</td>");d.push("</tr>");a.$body.find("tr[data-parent-index="+e.id+"]:first").before(p(d.join("")))});this.$selectGroup=[];this.$body.find('[name="btSelectGroup"]').each(function(){var d=p(this);a.$selectGroup.push({group:d,item:a.$selectItem.filter(function(){return(p(this).closest("tr").data("parent-index")===d.closest("tr").data("group-index"))})})});this.$container.off("click",".groupBy").on("click",".groupBy",function(){p(this).toggleClass("expanded");a.$body.find("tr[data-parent-index="+p(this).closest("tr").data("group-index")+"]").toggleClass("hidden")});this.$container.off("click",'[name="btSelectGroup"]').on("click",'[name="btSelectGroup"]',function(e){e.stopImmediatePropagation();var d=p(this);var f=d.prop("checked");a[f?"checkGroup":"uncheckGroup"](p(this).closest("tr").data("group-index"))})}q=false;this.updateSelected()};r.prototype.updateSelected=function(){if(!q){o.apply(this,Array.prototype.slice.apply(arguments));if((this.options.groupBy)&&(this.options.groupByField!=="")){this.$selectGroup.forEach(function(a){var b=a.item.filter(":enabled").length===a.item.filter(":enabled").filter(":checked").length;a.group.prop("checked",b)})}}};r.prototype.getGroupSelections=function(b){var a=this;return p.grep(this.data,function(c){return(c[a.header.stateField]&&(c._data["parent-index"]===b))})};r.prototype.checkGroup=function(a){this.checkGroup_(a,true)};r.prototype.uncheckGroup=function(a){this.checkGroup_(a,false)};r.prototype.checkGroup_=function(d,b){var a;var c=function(){return(p(this).closest("tr").data("parent-index")===d)};if(!b){a=this.getGroupSelections(d)}this.$selectItem.filter(c).prop("checked",b);this.updateRows();this.updateSelected();if(b){a=this.getGroupSelections(d)}this.trigger(b?"check-all":"uncheck-all",a)}}(jQuery);